# DevCore 

import os
import json
import random

SAVE_FILE = "partida_dios.json"

class Jugador:
    def __init__(self, nombre, nivel=1, xp=0, fuerza=10, vida=100, oro=100, inventario=None, equipo=None, habilidades=None):
        self.nombre = nombre
        self.nivel = nivel
        self.xp = xp
        self.fuerza = fuerza
        self.vida_max = 100 + nivel * 10
        self.vida = vida
        self.oro = oro
        self.inventario = inventario if inventario else []
        self.equipo = equipo if equipo else {"arma": None, "armadura": None}
        self.habilidades = habilidades if habilidades else []

    def esta_vivo(self):
        return self.vida > 0

    def atacar(self, enemigo):
        base = self.fuerza + (self.nivel * 2)
        arma_bonus = 5 if self.equipo["arma"] == "Espada legendaria" else 0
        danio = random.randint(base, base + 5 + arma_bonus)
        print(f"{self.nombre} ataca con fuerza {danio}.")
        enemigo.vida -= danio

    def usar_habilidad(self, enemigo):
        if "Golpe explosivo" in self.habilidades and self.nivel >= 3:
            print(f"ğŸ”¥ {self.nombre} usa Golpe explosivo!")
            danio = random.randint(25, 40)
            enemigo.vida -= danio
        else:
            print("âŒ No tienes habilidades desbloqueadas.")

    def ganar_xp(self, cantidad):
        self.xp += cantidad
        print(f"âœ¨ Ganaste {cantidad} XP.")
        if self.xp >= self.nivel * 30:
            self.nivel += 1
            self.xp = 0
            self.fuerza += 2
            self.vida_max += 20
            self.vida = self.vida_max
            print(f"\nğŸ†™ Subiste a nivel {self.nivel}! Fuerza y vida aumentadas.")
            if self.nivel == 3:
                self.habilidades.append("Golpe explosivo")
                print("ğŸ’¡ Â¡Has aprendido una nueva habilidad: Golpe explosivo!")

    def mostrar_estado(self):
        print(f"\nğŸ§™ {self.nombre} | Nivel {self.nivel} | Vida: {self.vida}/{self.vida_max} | Fuerza: {self.fuerza} | Oro: {self.oro}")
        print(f"ğŸ’ Inventario: {', '.join(self.inventario) if self.inventario else 'VacÃ­o'}")
        print(f"ğŸ›¡ï¸ Equipo: {self.equipo}")
        print(f"ğŸ’« Habilidades: {', '.join(self.habilidades) if self.habilidades else 'Ninguna'}")

    def curarse(self):
        if "PociÃ³n" in self.inventario:
            self.vida = min(self.vida + 50, self.vida_max)
            self.inventario.remove("PociÃ³n")
            print("ğŸ§ª Te curaste 50 puntos de vida.")
        else:
            print("âŒ No tienes pociones.")

class Enemigo:
    def __init__(self, nombre, vida, fuerza):
        self.nombre = nombre
        self.vida = vida
        self.fuerza = fuerza

    def esta_vivo(self):
        return self.vida > 0

    def atacar(self, jugador):
        danio = random.randint(self.fuerza - 3, self.fuerza + 3)
        print(f"{self.nombre} ataca y causa {danio} de daÃ±o.")
        jugador.vida -= danio

def guardar(jugador):
    with open(SAVE_FILE, "w") as f:
        json.dump(jugador.__dict__, f)
    print("ğŸ’¾ Partida guardada.")

def cargar():
    if os.path.exists(SAVE_FILE):
        with open(SAVE_FILE, "r") as f:
            data = json.load(f)
            return Jugador(**data)
    return None

def combate(jugador, enemigo):
    print(f"\nâš”ï¸ Â¡Te enfrentas a {enemigo.nombre}!")
    while jugador.esta_vivo() and enemigo.esta_vivo():
        print("\n1. Atacar")
        print("2. Usar habilidad")
        print("3. Usar pociÃ³n")
        opcion = input("> ")
        if opcion == "1":
            jugador.atacar(enemigo)
        elif opcion == "2":
            jugador.usar_habilidad(enemigo)
        elif opcion == "3":
            jugador.curarse()
        else:
            print("âŒ OpciÃ³n invÃ¡lida.")
            continue
        if enemigo.esta_vivo():
            enemigo.atacar(jugador)

    if jugador.esta_vivo():
        oro = random.randint(20, 60)
        jugador.oro += oro
        jugador.ganar_xp(20)
        drop = random.choice(["PociÃ³n", "Nada", "Espada legendaria"])
        if drop != "Nada":
            jugador.inventario.append(drop)
            print(f"ğŸ Encontraste: {drop}")
        print(f"ğŸ’° Ganaste {oro} de oro.")
    else:
        print("ğŸ’€ Has muerto. Fin del juego.")
        exit()

def tienda(jugador):
    print("\nğŸ›’ Tienda")
    catalogo = {"PociÃ³n": 30, "Armadura de hierro": 80}
    while True:
        print("Escribe nombre del objeto o 'salir'")
        for item, precio in catalogo.items():
            print(f"{item} - {precio} oro")
        opcion = input("> ").title()
        if opcion == "Salir":
            break
        elif opcion in catalogo:
            if jugador.oro >= catalogo[opcion]:
                jugador.oro -= catalogo[opcion]
                if "Armadura" in opcion:
                    jugador.equipo["armadura"] = opcion
                else:
                    jugador.inventario.append(opcion)
                print(f"âœ… Compraste {opcion}")
            else:
                print("âŒ No tienes suficiente oro.")
        else:
            print("âŒ No existe ese objeto.")

def mapa(jugador):
    while True:
        jugador.mostrar_estado()
        print("\nğŸŒ DÃ³nde quieres ir?")
        print("1. Bosque (enemigos)")
        print("2. Mazmorra (jefe)")
        print("3. Ciudad (tienda / descanso)")
        print("4. Guardar partida")
        print("5. Salir")
        opcion = input("> ")

        if opcion == "1":
            enemigo = Enemigo("Orco", 60 + jugador.nivel * 10, 10 + jugador.nivel)
            combate(jugador, enemigo)
        elif opcion == "2":
            enemigo = Enemigo("SeÃ±or Oscuro", 150, 20)
            combate(jugador, enemigo)
        elif opcion == "3":
            print("\nğŸ˜ï¸ Bienvenido a la ciudad.")
            print("1. Tienda")
            print("2. Descansar (+vida)")
            print("3. Volver")
            sub = input("> ")
            if sub == "1":
                tienda(jugador)
            elif sub == "2":
                jugador.vida = jugador.vida_max
                print("ğŸ’¤ Te has recuperado completamente.")
        elif opcion == "4":
            guardar(jugador)
        elif opcion == "5":
            print("ğŸ‘‹ Fin del juego.")
            break
        else:
            print("âŒ OpciÃ³n invÃ¡lida.")

def menu():
    while True:
        print("\n=== CodeVerse Legends ===")
        print("1. Nueva partida")
        print("2. Cargar partida")
        print("3. CrÃ©ditos")
        print("4. Salir")
        opcion = input("> ")

        if opcion == "1":
            nombre = input("Nombre del hÃ©roe: ")
            jugador = Jugador(nombre)
            mapa(jugador)
        elif opcion == "2":
            jugador = cargar()
            if jugador:
                print("âœ… Partida cargada.")
                mapa(jugador)
            else:
                print("âš ï¸ No se encontrÃ³ ninguna partida.")
        elif opcion == "3":
            print("ğŸ® Juego creado por CodeVerse | Python puro | Terminal RPG")
        elif opcion == "4":
            print("ğŸ‘‹ Gracias por jugar.")
            break
        else:
            print("âŒ OpciÃ³n invÃ¡lida.")

if __name__ == "__main__":
    os.system("cls" if os.name == "nt" else "clear")
    menu()
